E-Labsheet Docker
=================

Docker compose configuration for running E-Labsheet system in Docker.

Usage
-----
To build required Docker images, run the script:

```bash
./build.sh
```

Start all the containers with:

```bash
docker-compose up -d
```

Add the following lines into your Nginx's `server` block:

    location = /elab {
        return 302 /elab/;
    }
    location /elab/ {
        proxy_pass http://localhost:8888/;
        proxy_redirect off;
        proxy_set_header Host $http_host;
        proxy_set_header X-Elab-Client-IP $remote_addr;
    }

Restart Nginx, then set your browser to `http://<your-host>/elab/`.

Default Django and MySQL usernames and passwords can be found and configured in
the file `docker-compose.yaml`.  In case of MySQL user, the file
`src/elabsheet/elabsheet/settings_local.py`, generated by the `build.sh`
script, must also be changed to match.

## How to check running services 

- All containers 

Run this command
```bash
docker ps
```
Check these container names are running
```
elab-db
elab-web
elab-grader
elab-nginx
elab-nginx-proxy
```
- elab-web

Run this command
```bash
docker logs -f elab-web
```
Wait until this line is shown
```
[Thu Feb  6 04:32:15 UTC 2020] Starting elab as elab
```

- elab-grader

Run this command
```bash
docker logs -f elab-grader
```
Wait until these lines are shown
```
[2020-02-06 11:32:26.407296] Grader started with PID 1186
[2020-02-06 11:32:26.412018] Log file: /home/elab/app/elabsheet/grader/log/1186.log
```